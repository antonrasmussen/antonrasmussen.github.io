<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Transport Layer Security and Network Layer Security</title>
	</head>
	
	<body>



		<div id="navigator">
			<p><a href="https://antonrasmussen.github.io">antonrasmussen.github.io:</a> > CYSE462_notes > Transport Layer Security and Network Layer Security</p>

		</div><!--navigator-->

		<div class="overview">
		<!--Module 15.0-->

			<h2>Overview</h2>

			<p>
				This the final module in the course and covers mechanism for transport layer security and network layer security.  Transport layer security functions are implemented in SSL/TLS protocols, network layer security is implemented in IPSec.  We will cover both of these protocols at a high level.
			</p>

		</div> <!--overview-->

		<div class="objectives">


			<h3>Objectives</h3>

			<p>At the end of this module, students will be able to:</p>

			<ul>
				<li>Describe the components that provide for Secure Socket Layer/Transport Layer Security (SSL/TLS) between two hosts.</li>
				<li>Describe the SSL/TLS handshake protocol.</li>
				<li>Explain the critical role IPSec plays in providing secure communications over the IP layer.</li>
				<li>Explain how keys can be managed in IPSec using the Internet Key Exchange (IKE)</li>
				<li>Explain the basic idea behind the Diffie-Hellman key exchange protocol.</li>
			</ul>


		</div> <!--objectives-->

		<div class="relevance">
				<h3>Relevance</h3>

				<p>
					SSL/TLS is used to implement HTTPS, the encrypted version of HTTP.&nbsp; This is vitally important for people who use the Internet for shopping or banking (i.e., almost everyone).&nbsp; IPSec is becoming more popular as a technique for protecting communications at the network layer (which would also protect transport layer communications).
				</p>

		
		</div> <!--relevance-->


		<div class="transport_layer_security">
		<!--Module 15.1-->

			<h2>Transport Layer Security</h2>

			<img src='ssl-layer.png' alt="" border="0" width="700" height="344"/>

			<p>Watch the following short video to get an overview of HTTPS and TLS/SSL</p>

			<p>Professor Messer, &#x201C;<a href="http://www.professormesser.com/security-plus/sy0-401/https-and-tls-ssl-2/" target="_blank">HTTPS and TLS/SSL</a>&#x201D;, July 2014</p>

			<ul>
				<li>2:22</li>
				<li><a href="http://www.professormesser.com/security-plus/sy0-401/https-and-tls-ssl-2/" target="_blank">http://www.professormesser.com/security-plus/sy0-401/https-and-tls-ssl-2/</a></li>
				<li>&#x201C;Without encryption, we would not be able to securely use our network connections. In this videos, you&#x2019;ll learn how your browser encrypts all of the information you send to a web server using HTTPS or TLS/SSL.&#x201D;</li>
			</ul>

			<h3>Reading Assignment:</h3>

			<ul>
				<li>Introduction to Section 8.6 &#x2013; &quot;Securing TCP Connections: SSL&quot;</li>
				<li>Section 8.6.1 - &quot;The Big Picture&quot;</li>
			</ul>

			<p><em>Optional</em>: For more in-depth information on SSL, read</p>

			<ul>
				<li>Section 8.6.2 - &quot;A More Complete Picture&quot;</li>
				<li>&quot;SSL: Foundation for Web Security&quot;, William Stallings (similar to Ch 6.2 in Stallings text), <a href="http://www.cisco.com/web/about/ac123/ac147/archived_issues/ipj_1-1/ssl.html" target="_blank">http://www.cisco.com/web/about/ac123/ac147/archived_issues/ipj_1-1/ssl.html</a></li>
			</ul>

			<h3>Learning Check</h3>

			<ul>
				<li>What is HTTPS?</li>
				<li>How can you tell if a website is using HTTPS?</li>
				<li>What is the difference between TLS and SSL?</li>
				<li>What security properties does SSL enhance TCP with?</li>
				<li>What are the three phases of the SSL protocol?</li>
				<li>What is the purpose of the handshake protocol?</li>
				<li>What are the four keys that are generated by the client and server (or Alice and Bob) using the Master Secret (MS)?</li>
				<li>How does SSL use sequence numbers to prevent a man-in-the-middle attack?&nbsp;</li>
			</ul>

			<h3>The Big Picture</h3>

			<p>Note (as the textbook does) that the description here is a simplified version of SSL.&nbsp; For details about the actual SSL, see the optional readings provided on the previous page.</p>

			<p>SSL has three phases: handshake, key derivation, and data transfer.</p>

			<p>The goals of the handshake phase (using our Alice and Bob examples) are</p>

			<ol>
				<li>Bob establishes a TCP connection with Alice</li>
				<li>Bob verifies that Alice really is Alice</li>
				<li>Bob sends Alice a master secret key (MS), used to generate all of the symmetric keys used in the session</li>
			</ol>

			<img src='ssl-handshake.png' alt="Diagram demonstrating handshake" border="0" width="600" height="506" />

			<p><span>Alice and Bob now share a secret key MS.&nbsp; But to increase security, they don&#39;t use this key directly for communication.&nbsp; Instead, they use MS to derive four other keys:</span></p>

			<ul>
				<li>E<sub>B</sub> - session encryption key for data sent from Bob to Alice</li>
				<li>M<sub>B</sub> - session MAC key for data sent from Bob to Alice</li>
				<li>E<sub>A</sub> - session encryption key for data sent from Alice to Bob</li>
				<li>M<sub>A</sub> - session MAC key for data sent from Alice to Bob</li>
			</ul>

			<p>Now, Alice and Bob share all 4 keys (E<sub>B</sub>, M<sub>B</sub>, E<sub>A</sub>, M<sub>A</sub>). The two E keys will be used for encryption/decryption, and the two M keys will be used to generate the MAC of the data for message integrity.</p>

			<p>The image below shows the SSL record for a transmission from Bob to Alice.&nbsp;</p>

			<img src='ssl-record.png' alt="" border="0" width="700" height="139" />

			<p>The fields are as follows:</p>

			<ul>
				<li>type - handshake or application data</li>
				<li>version - SSL version</li>
				<li>length - used to extract SSL record out of the TCP byte stream</li>
				<li>data - encrypted with E<sub>B</sub>&nbsp;-- <em>for data sent from Bob to Alice</em></li>
				<li>MAC - generated using M<sub>B</sub> and encrypted (along with the data) with E<sub>B </sub>--&nbsp;<em>for data sent from Bob to Alice</em></li>
			</ul>

			<p>As described in the reading, the data from the application layer is split up so that a MAC can be computed for data integrity.&nbsp; The image below shows how data is split from the application layer into SSL records.</p>

			<img src='ssl-encapsulation.png' alt="Encapsulation chart" border="0" width="700" height="349" />

			<h3>HTTPS - Putting Everything Together</h3>

			<p>As mentioned previously, HTTPS encrypts the session data using SSL.&nbsp; For web pages using SSL, the URL will begin with https:// instead of http://</p>

			<p>HTTPS provides both server authentication and encrypted communication between the web client and web server.</p>

			<p>
				How does HTTPS work?&nbsp; Let&apos;s walk through the operations that a web client and web server would perform to set up and use HTTPS.
			</p>

			<p>
				First, we assume that the web server has obtained a certificate validating who it says it is. This certificate contains <strong>CA<sup>-</sup> (S<sup>+</sup>, ID information)</strong>, where CA<sup>-</sup> is the certificate authority&apos;s private key and S<sup>+</sup> is the web server&apos;s public key.
			</p>

			<p>
				To begin the authentication process, the web server sends <strong><em>m</em>, S<sup>-</sup>(<em>m</em>), CA<sup>-</sup> (S<sup>+</sup>, ID information)</strong> to the client
			</p>

			<p>
				The client then uses the CA&apos;s public key CA<sup>+ </sup>to open the certificate and can then retrieve the server&apos;s public key, S<sup>+</sup>
			</p>

			<p>Then, the client uses server&apos;s public key S<sup>+ </sup>to decrypt the encrypted message S<sup>-</sup>(<em>m</em>)</p>

			<p>
				The client compares the resulting message to the unencrypted message <em>m</em>.&nbsp; If these match, then the client has authenticated the web server because only the owner of the S<sup>-</sup> could have encrypted the message and the certificate authority has verified that S is who they say they are.&nbsp; (We&apos;re putting a lot of trust in the certificate authority here, but there <em>has</em> to be some trusted third party.)
			</p>

			<p>Now, the client can encrypt its messages with the web server&apos;s public key, S<sup>+</sup>.</p>


		</div> <!--transport_layer_security-->

		<div class = "network_layer_security">
		<!--Module 15.2-->

			<h2>Network Layer Security</h2>

			<p>The rest of this module focuses on network layer security techniques.&nbsp; The focus will be on IPsec and Internet Key Exchange, which uses the Diffie-Helman key exchange protocol.</p>

			<p>IPsec has two principal protocols:</p>

			<ul>
				<li>Authentication Header (AH) protocol - provides source authentication and data integrity, but <em>not</em> confidentiality</li>
				<li>Encapsulation Security Payload (ESP) protocol - provides source authentication, data integrity, <em>and</em> confidentiality</li>
			</ul>

			<p>Because confidentiality is so important in many IPsec applications, ESP is more widely used than AH.</p>

			<p>Watch the following short video to get an overview of IPsec</p>

			<p>Professor Messer, &#x201C;<a href="https://www.professormesser.com/security-plus/sy0-401/ipsec-3/" target="_blank">IPsec</a>&#x201D;, July 2014</p>

			<ul>
				<li>1:38</li>
				<li><a href="https://www.professormesser.com/security-plus/sy0-401/ipsec-3/" target="_blank">http://www.professormesser.com/security-plus/sy0-401/ipsec-3/</a></li>
				<li>&#x201C;If you&#x2019;re concerned about the security of your network connections, then the IPsec protocol suite is for you. In this video, you&#x2019;ll learn the basics of IPsec technology.&#x201D;</li>
			</ul>

			<p><strong>Reading Assignment:</strong> Section 8.7 &#x2013; Network-Layer Security: IPsec and VPNs in the textbook.&nbsp; <em>The goal of the reading here is to get a general idea of how IPsec works, don&apos;t worry about the details.</em></p>

			<h3>Learning Check</h3>

			<ul>
				<li>What types of security services could network layer security provide?</li>
				<li>What is a VPN?</li>
				<li>How is inter-office traffic protected in a VPN?</li>
				<li>What are the two principal protocols in IPsec?</li>
				<li>Why is ESP more widely used than AH?</li>
				<li>What is a security association?</li>
				<li>What services does IPsec provide?</li>
				<li>What is a one-way function?</li>
				<li>What&#x2019;s the basic idea behind Diffie-Helman?</li>
				<li>What is prime factorization?&nbsp; Why is it hard?</li>
			</ul>

			<h3>Internet Key Exchange (IKE)</h3>

			<p>The security associations (SAs) in IPsec use shared encryption keys.&nbsp; Recall that the problem with shared keys is in getting both sides to agree upon the same key without an intruder also being able to determine the key.</p>

			<p>The whole idea behind Internet Key Exchange (IKE) is that we want to be able to use symmetric cryptography because it&apos;s faster, but the two hosts first need a way to securely decide upon the shared secret key.</p>

			<p>Watch the following video for a physical-world demonstration of key exchange.</p>

			<p><iframe allowfullscreen frameborder="0" height="315" src="https://www.youtube.com/embed/U62S8SchxX4" width="560"></iframe></p>

			<p><small><a href="https://www.youtube.com/watch?v=U62S8SchxX4">Key Exchange</a></small><br>
			<small>Chris Bishop</small><br>
			<small>Jun 2009</small><br>
			<small>3:29</small><br>
			<small>&#x201C;This clip from the 2008 Royal Institution Christmas Lectures shows a simple demonstration of how two people can agree on a secret key, even though all of their communications are carried out in public. In the electronic world, secret key exchange allows computers to communicate securely, and is used, for example, when you give your credit card information to an on-line shop.&#x201D;</small></p>

			<p>The Internet Key Exchange protocol is a bit more complicated than the demonstration shown in the video, but the basic idea is the same.</p>

			<h3>Diffie-Helman</h3>

			<p>Internet Key Exchange (IKE) uses the Diffie-Hellman key exchange protocol.&nbsp;<span>Watch this video for an overview of the Diffie-Hellman Key Exchange protocol.</span></p>

			<p><iframe allowfullscreen frameborder="0" height="315" src="https://www.youtube.com/embed/3QnD2c4Xovk" width="420"></iframe></p>

			<p><small><a href="http://www.youtube.com/watch?v=3QnD2c4Xovk">Diffie-Hellman Key Exchange</a></small><br>
			<small>Public Key Cryptography: Diffie-Hellman Key Exchange</small><br>
			<small>February 2012</small><br>
			<small>5:24</small><br>
			<small>&#x201C;Diffie-Hellman key exchange was one of the earliest practical implementations of key exchange within the field of cryptography. It relies on the discrete logarithm problem.&#x201D;</small></p>

			<p>Using the same notation from the Diffie-Hellman calculator (below), here are the steps used in the example in the video:</p>

			<ul>
				<li>Alice and Bob publicly agree upon a prime modulus (<em>n=</em>17) and a generator (<em>g=</em>3).</li>
				<li>Alice chooses a private random number, <em>a=</em>54</li>
				<li>Alice computes <em>A =&nbsp;</em><em>g<sup>a </sup></em>mod <em>n</em>&nbsp;=&nbsp;3<sup>54</sup> mod 17&nbsp;= 15 and sends <em>A&nbsp;</em>to Bob</li>
				<li>Bob chooses his private random number, <em>b=</em>24</li>
				<li>Bob computes <em>B =&nbsp;</em><em>g<sup>b&nbsp;</sup></em><span>mod&nbsp;</span><em>n</em><span>&nbsp;=&nbsp;3</span><sup>24</sup><span>&nbsp;mod 17 = 16&nbsp;and sends&nbsp;<em>B</em>&nbsp;to Alice.&nbsp;</span></li>
				<li>Alice takes Bob&apos;s public result (<em>B=</em>16) and raises it to the power of her private number (<em>a=</em>54)
					<ul>
						<li><em>M =&nbsp;B<sup>a</sup>&nbsp;</em>mod<em> n</em> =&nbsp;16<sup>54</sup> mod 17 = 1</li>
						<li>Note that <em>B<sup>a</sup>&nbsp;</em>mod&nbsp;<em>n&nbsp;</em>= <em>g</em><sup><em>(ba)</em></sup> mod<em> n</em></li>
					</ul>
				</li>
				<li>Bob takes Alice&apos;s public result (<em>A=</em>15) and raises it to the power of his private number (<em>b=</em>24)
					<ul>
						<li><em>M =&nbsp;A<sup>b</sup>&nbsp;</em>mod<em>&nbsp;n</em>&nbsp;=&nbsp;15<sup>24</sup>&nbsp;mod 17 = 1</li>
						<li>Note that&nbsp;<em>A<sup>b</sup>&nbsp;</em>mod&nbsp;<em>n&nbsp;</em>=&nbsp;<em>g</em><sup><em>(ab)</em></sup>&nbsp;mod<em>&nbsp;n</em></li>
					</ul>
				</li>
				<li>Now, Bob and Alice share the same key, but the intruder would have to know one of the private random numbers <em>a </em>or <em>b&nbsp;</em>(which have never been transmitted) in order to compute the key.</li>
			</ul>

			<p>Experiment with the Diffie-Hellman calculator at <a href="http://dkerr.home.mindspring.com/diffie_hellman_calc.html">http://dkerr.home.mindspring.com/diffie_hellman_calc.html</a></p>


		</div> <!--network_layer_security-->


		<style>

		a { color:blue; }
	
			a:hover { color:red; }

		h1 { font-size:1.1em; text-align:center; }

		body { font-family:verdana; font-size:medium; text-align:left; }

	    	#navigator { text-align:left; margin:auto; }

			div.overview { color:black; }

			#video_transcript { color:grey; }

			div.intro p {	color:blue; }

			div.objectives { color:green; }

			div.relevance { color:red; }
		
		</style>
	
	</body>


</html>